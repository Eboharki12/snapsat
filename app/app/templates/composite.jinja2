{% extends "base.jinja2" %}


{% block title %}
<title>{{ meta_data.scene_id }} | Snapsat</title>
{% endblock %}

{% block content %}

<div class='container clearfix mt4 p1'>

  {% for band_combo, composite in composites.iteritems() %}

  <h2 class='center mb3'>
    A 
    {{ composite.band1 }}{{ composite.band2 }}{{ composite.band3 }}
    composite of {{ meta_data.scene_id }}
  </h2>

  <div class='sm-col sm-col-6 p1'>
    <!-- Display preview image -->
    <a href='' class='js-preview'>
      <img src='{{ composite.previewurl }}'>
    </a>
  </div>

  <div class='sm-col sm-col-6 p1'>


    <h3>Interpreting this image</h3>
    {% include 'scene/band-descriptions.jinja2' %}


    <!-- Full render download button -->
    {% if composite.fullurl %}
    <a  class='button bg-silver black' 
        href='{{ composite.fullurl }}'>
        Download a fullsize render
    </a>

    <!-- If a full render has NOT been created, display a means of creating one. -->
    {% else %}
    <div class='js-nofull' id='{{composite.fulljobid}}'>
      <h3>Download</h3>
      <p class='h5'>We can usually render a full-sized composite in 3 minutes. If you don't mind waiting, just stay here. Otherwise, we'll gladly notify you via email when it's finished.</p>
      <!-- If a full has been requested, display the processing status. -->
      {% if composite.fullstatus %}
      <a  class='button bg-silver black' 
          id='js-fullstatus'>
          {{ composite.fullstatus }}
      </a>

      <!-- If a full has not been requested, display a button to do so. -->
      {% else %}
      <!-- <button id='js-opener{{band_combo}}' --> 
      <!--   class='button not-rounded left full-width center'> -->
      <!--   Request a full size image. -->
      <!-- </button> -->

      <!-- Modal for optional email -->
      <div id='js-dialog{{band_combo}}' class='js-modal' title='Email notification'>
        <form method='post'>
          <input class='mb1 left' type='email' name='email_address' placeholder='Email (optional)'/>
          <input type='hidden' name='band1' value='{{ composite.band1 }}'/>
          <input type='hidden' name='band2' value='{{ composite.band2 }}'/>
          <input type='hidden' name='band3' value='{{ composite.band3 }}'/>
          <button
            class='button rounded-right left bg-silver black'
            formaction='/request/full/{{ meta_data.scene_id }}/'
            formmethod='post'
            type='submit'>Request a full size image.
          </button>
        </form>
      </div>
      <script src='/static/js/email.js'></script>

      {% endif %}
    </div> <!-- nofull -->

    {% endif %}
  </div>

{% endfor %}
</div>

{% endblock %}
