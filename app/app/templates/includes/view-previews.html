<title>Creating a modal window with HTML5 &amp; CSS3</title>

<style>
.modalDialog {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background: rgba(0,0,0,0.8);
    z-index: 99999;
    opacity:0;
    -webkit-transition: opacity 400ms ease-in;
    -moz-transition: opacity 400ms ease-in;
    transition: opacity 400ms ease-in;
    pointer-events: none;
    color: #000;
}

.modalDialog:target {
    opacity:1;
    pointer-events: auto;
}

.modalDialog > div {
    width: 400px;
    position: relative;
    margin: 10% auto;
    padding: 5px 20px 13px 20px;
    border-radius: 10px;
    background: #fff;
    background: -moz-linear-gradient(#fff, #999);
    background: -webkit-linear-gradient(#fff, #999);
    background: -o-linear-gradient(#fff, #999);
    pointer-events: none;
    overflow: hidden;
}

.close {
    background: #606061;
    color: #FFFFFF;
    line-height: 25px;
    position: absolute;
    right: -12px;
    text-align: center;
    top: -10px;
    width: 24px;
    text-decoration: none;
    font-weight: bold;
    -webkit-border-radius: 12px;
    -moz-border-radius: 12px;
    border-radius: 12px;
    -moz-box-shadow: 1px 1px 3px #000;
    -webkit-box-shadow: 1px 1px 3px #000;
    box-shadow: 1px 1px 3px #000;
}

.close:hover { background: #00d9ff; }
</style>

<div class='preview-container clearfix px5 mt4 mb4 bg-black'>

    {% for band_combo, composite in composites.iteritems() %}

    <div class='js-preview sm-col sm-col-6 md-col md-col-4 lg-col lg-col-3 relative' id='{{ band_combo }}'>

        <!-- Scene composite metadata -->
        <div class='scene-meta white full-width'>

            <!-- Full render download button -->
            {% if composite.fullurl %}
                <a  class='button not-rounded full-width center' 
                    href="{{ composite.fullurl }}">Download full size image.
                </a>

            <!-- If a full render has NOT been created, display a means of creating one. -->
            {% else %}
                <div class='js-nofull' id='{{composite.fulljobid}}'>

                    <!-- TODO: This is currently handled poorly. -->
                    <!-- If a full has been requested, display the processing status. -->
                    {% if composite.fullstatus %}
                        <a  class='button not-rounded full-width center' id='js-fullstatus'>{{ composite.fullstatus }}</a>
                    {% else %}
                        <!-- Display a button that causes a full render to be queued. -->
                        <form method='get' class='request-render'>
                            <button
                                class='button not-rounded left full-width center'
                                formaction="#openModal"
                                formmethod="get"
                                type="submit">Request a full size image.
                            </button>
                        </form>
                        {# <a href="#openModal">Open Modal</a> #}

                        <div id="openModal" class="modalDialog">
                            <div>
                                <a href="#close" title="Close" class="close">X</a>
                                <h2>Request a full size image</h2>
                                <form method='post'>
                                    <input class='left full-width center' type="email" name="email_address" placeholder="Email (optional)"/>
                                    <input type="hidden" name='band1' value="{{ composite.band1 }}"/>
                                    <input type="hidden" name='band2' value="{{ composite.band2 }}"/>
                                    <input type="hidden" name='band3' value="{{ composite.band3 }}"/>
                                    <p>Normally, a full render is ready for download in 3 minutes, but high traffic volumes can lead to a longer wait.</p>
                                    <p>If you'd like, we will send an email when your full render is complete.</p>
                                    <button
                                        class='button not-rounded left full-width center'
                                        formaction="/request_composite/{{ meta_data.scene_id }}"
                                        formmethod="post"
                                        type="submit">Request a full size image.
                                    </button>
                                </form>
                            </div>
                        </div>
                    {% endif %}
                </div> <!-- nofull -->
            {% endif %}
        </div> <!-- scene-meta -->

        <div class='preview-block'>
            <!-- Scene barcode visualization -->
            <div class='js-graph' id='graph{{composite.previewjobid}}'></div>
            
            <!-- Display the band combination of the composite -->
            <h1 class='composite-description'>
                    <span class='band-red red'>{{ composite.band1 }}</span> <span class='band-green green'>{{ composite.band2 }}</span> 
                    <span class='band-blue blue'>{{ composite.band3 }}</span>
            </h1>
        </div>

        <!-- Display preview or loading gif -->
        <div id='{{composite.previewjobid}}'>
            {% if composite.previewurl %}
                <a href="{{ composite.previewurl }}">
                    <img src="{{ composite.previewurl }}">
                </a>
            {% else %}
            <div class='js-nopreview' id='{{composite.previewjobid}}'>
                <img class='loading' src="/static/img/loading.gif">
            </div>
            {% endif %}
        </div>
    </div> <!-- preview -->
    {% endfor %}
</div> <!-- preview-container -->


